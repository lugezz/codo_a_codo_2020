/* Version=6.6.14,Timestamp=2020-12-24T09:28:36.549Z */define("d2-recipe-listing",["slick","commonService","ratingService","listing","bootstrapRangeSlider"],function(){"use strict";return IEA.module("UI.recipe-listing",function(e,t,i){var c=null,l=null,p=null,d=null;_.extend(e,{defaultSettings:{alternateResult:".c-recipe-listing__alternate-results",carouselCl:".js-related-recipes-carousel",carouselSpeed:500,changeToHoursTemplate:"partials/recipe-attribute-change-to-hours.hbss",filterActiveCl:"filter-active",filterContainer:".c-recipe-listing-filter__container",filterLabelWrapper:".c-listing-filter__label",filterResultCount:".c-filter__resultcount",filtertags:".js-filter-tags",filtertagsLabel:".c-filter-tags__label",filtertagsLabelDisplay:"c-filter-tags__label-display",filterTypeDropdown:".c-listing-v2-filter__dropdown",filterWrapper:".c-listing-filter__filter",filterWrapperSticky:".c-filter-tags",filterHeadingSticky:".c-filter-tags__sticky-heading",hiddenClass:"hidden",isLoadMore:!1,isPageLoad:!0,loadmoreBtn:".js-btn-loadmore",loadmoreWrapper:".c-recipe-listing__loadmore",moreFilter:".c-filter-more",noResult:".c-recipe-listing-noResult",pageNum:1,pagination:".c-recipe-listing-pagination",paginationBtn:".js-btn-pagination",paginationTemplate:"pagination/defaultView.hbss",preloader:".c-recipe-listing__loadmore .o-preloader",preloaderContent:".o-preloader--content",queryParamsStore:[],rangeSliderInputWrapper:".js-rangefinder",recipeAttrListItem:".c-recipe-attributes__list-item",recipeAttrValueWrapper:".c-recipe-attributes-value",recipeAttrValue:".c-recipe-attributes__value",recipeDALabel:".c-recipe-dietary-attributes__label",recipeDAListItem:".c-recipe-dietary-attributes__list-item",recipeFilterBlock:".c-recipe-listing-filter__block",recipeFilterExpand:".c-recipe-listing-filter__expand",recipeFilters:".c-recipe-listing-filter",recipeListingList:".c-recipe-listing__list",recipeSorting:".c-recipe-listing-sorting",recipeTagsItems:".c-recipe-listing__tags-item",searchWrapper:".c-recipe-listing__wrapper",showFilter:".c-filter-see",slidesToShow:3,slidesToShowMob:1,startIndex:1,startPageNum:1,template:"partials/recipe-listing.hbss",pageNavCount:5,radioBtnFilterWrapper:".o-filter-radio",triStateFilterWrapper:".o-filter-tristate",multiValueFilterWrapper:".o-filter-multivalue",enableHistory:!0,urlSeprator:"~",urlCharacterLimit:300,recipeTemplate:"recipe-listing/landingView.hbss"},events:{"change .c-listing-filter__filter":"_filterChangeHandler","click .js-apply-filters":"_filterApplyHandler","click .js-cancel-filters":"_filterCancelHandler","click .js-clear-filters":"_filterClearHandler","click .js-more-filters":"_filterExpandHandler","click .js-see-filters":"_filterSeeHandler","click .js-remove-filtertag":"_removeFilterTagHandler","click .js-btn-loadmore":"_loadMorehandler","click .js-btn-pagination":"_paginationHandler","click .js-filter-rangefinder-reset":"_resetRangeFilter"},initialize:function(e){this._super(e),c=new IEA.commonService,l=new IEA.ratingService,p=new IEA.Listing,this.triggerMethod("init")},render:function(){return this.getModelJSON().recipeListing.isMigrationEnabled||this.$el.html(this.template(this.getModelJSON())),!1===this._isEnabled&&(this.enable(),this._isEnabled=!0),this.triggerMethod("render"),this},enable:function(){this.triggerMethod("beforEnable");var e=this;e.componentJson=e.getModelJSON().recipeListing,e.settings=e.defaultSettings,e.isRecipes=!0,e.sortElmVal="",e.pageNum=e.settings.pageNum,e.pageScroll=!1,e.pagination=e.$el.find(e.settings.pagination),e.loadmoreWrapper=e.$el.find(e.settings.loadmoreWrapper),e.isPageLoad=e.settings.isPageLoad,e.preloaderContent=e.$el.find(e.settings.preloaderContent),e.recipeList=e.$el.find(e.settings.recipeListingList),e.startIndex=e.settings.startIndex,e.listingItem=e.settings.listingItem,e.selectedFiltersIndex=0,e.activeState=!1,e.showFilter=e.settings.showFilter,e.filterWrapperSticky=e.settings.filterWrapperSticky,e.clearFilter=e.settings.clearFilter,e.recipeSorting=e.settings.recipeSorting,e.recipeFilterExpand=e.settings.recipeFilterExpand,e.moreFilter=e.settings.moreFilter,e.recipeFilterBlock=e.settings.recipeFilterBlock,e.alternateResult=e.settings.alternateResult,e.listingResponse=!0,e.rangeSliderInputWrapper=e.$el.find(e.settings.rangeSliderInputWrapper),e.filterResultCount=e.settings.filterResultCount,e.hiddenClass=e.settings.hiddenClass,e.filterId="fl_"+e.componentJson.componentPosition,e.urlSeprator=e.settings.urlSeprator,e.favCalled=!1,e.componentJson.isMigrationEnabled?"favoritesList"===e.componentJson.recipeConfig.componentUsageContext&&e.componentJson.favouritesEnabled?require(["favourites"],$.proxy(e._favRequireCallback,e)):e._getRecipeData(e.componentJson):e._enableCallBack()},_enableCallBack:function(){var e=this;e.settings.enableHistory&&(e.pushHistory=window.performance.navigation.type<=1,e.isHistoryPop=!1,c.historyPopStateBind(e.historyBackHandler,this)),"list-view"===e.componentJson.componentVariation&&"favoritesList"!==e.componentJson.recipeConfig.componentUsageContext&&(e.pageScroll=!1,e.componentJson.recipeConfig.filterConfig&&e.componentJson.recipeConfig.filterConfig.filterOptions&&e._initRangeSliderFilter(),e.$el.find(this.defaultSettings.loadmoreBtn).length&&_.throttle(p.handleLoadMore(e),250),e.componentJson.recipeConfig.pagination&&e._renderPagination(e.componentJson.recipeConfig.totalCount),e.$el.find(e.showFilter).addClass(e.hiddenClass),e.componentJson.isMigrationEnabled||e.$el.find(e.filterResultCount).find("span").text(e.componentJson.recipeConfig.totalCount),e.componentJson.recipes.length&&e.componentJson.recipeConfig.filterConfig&&e.componentJson.recipeConfig.filterConfig.filterOptions&&e.componentJson.recipeConfig.filterConfig.filterOptions.length&&e._stickyFilter()),e.componentJson.isMigrationEnabled?(e._showRecipeAttributesNew(),e._showRecipeDietaryAttributesNew(),e.$el.find(e.filterResultCount).find("span").text(e.componentJson.recipeConfig.totalCount)):(e._showRecipeAttributes(),e._showRecipeDietaryAttributes()),e._renderRatings(e.componentJson.recipes,e.componentJson.brandName),""!==window.location.search&&this.defaultSettings.enableHistory&&($(e.preloaderContent).removeClass("hidden"),p.getUrlParameter(e.filterId)||(this.activeState=!0),this.historyFilterHandler(this,!0)),e._initCarousel(),e.componentJson.favouritesEnabled&&!e.favCalled&&require(["favourites"],$.proxy(e._favRequireCallback,e)),this.triggerMethod("enable")},_getRecipeData:function(){var n=this,e={};(e=n._getRecipeMigrationOption("")).onCompleteCallback=function(i){var e;(i=i&&$.parseJSON(i))&&i.hits&&i.hits.hits?(n.componentJson.recipeConfig.totalCount=i.hits.total.value,(i=i.hits.hits).forEach(function(e,t){i[t].args=[],i[t].args.push(n.componentJson)}),n.componentJson.recipes=i,e=n.getTemplate("recipe-listing",n.defaultSettings.recipeTemplate),n.$el.html(e(n.getModelJSON())),n._enableCallBack()):n.$el.hide()},e.onErrorCallback=function(e){n.$el.hide()},c.getDataAjaxMethod(e)},_getRecipeMigrationOption:function(e){var t=this,i={},n={};return t.componentJson.recipeConfig.pagination&&(n.from=t.pageNum.toString(),n.size=t.componentJson.recipeConfig.pagination.itemsPerPage.toString()),n.recipeUrl=t.componentJson.recipeUrl,n.imageRenditions=t.componentJson.imageRenditions,n.imageurl=t.componentJson.imageurl,"categoryOrLandingPages"!==t.componentJson.recipeConfig.componentUsageContext&&"productDetailsPage"!==t.componentJson.recipeConfig.componentUsageContext||!t.componentJson.group||$.each(t.componentJson.group,function(e,t){n[e]=t}),e&&$.each(e,function(e,t){n[e]=t}),i.queryParams=JSON.stringify(n),i.isTypePost=!0,i.servletUrl=t.componentJson.recipeEndPoint,i.header={locale:t.componentJson.locale,brand:t.componentJson.brandName,recipeId:t.componentJson.recipeId,componentUsageContext:t.componentJson.recipeConfig.componentUsageContext},i},_getRecipeMigrationOptionFav:function(){var e=this,t={},i={};return e.componentJson.recipeConfig.pagination&&(i.from=e.pageNum.toString(),i.size=e.componentJson.recipeConfig.pagination.itemsPerPage.toString()),i.recipeUrl=e.componentJson.recipeUrl,i.imageRenditions=e.componentJson.imageRenditions,i.imageurl=e.componentJson.imageurl,t.queryParams=JSON.stringify(i),t.isTypePost=!0,t.servletUrl=e.componentJson.recipeEndPoint,t.header={locale:e.componentJson.locale,brand:e.componentJson.brandName,recipeId:e.componentJson.recipeId,componentUsageContext:e.componentJson.recipeConfig.componentUsageContext},t},_favRequireCallback:function(){var t,n,i,r=this,a="",e={},o="",s={};d=new IEA.Favourites(r.componentJson),"favoritesList"===r.componentJson.recipeConfig.componentUsageContext&&!r.listingDOMInjected&&r.listingResponse&&(r.componentJson.isMigrationEnabled?(s=JSON.parse(c.getLocalStorageItem("favourites-"+r.componentJson.brandName+"-"+r.componentJson.locale)),i=[],s.recipeIds.forEach(function(e){i.push(e)}),o=i.join("|"),r.componentJson.recipeId=o,(e=r._getRecipeMigrationOptionFav()).onCompleteCallback=function(i){i&&(i=$.parseJSON(i)).hits&&i.hits.hits?i.length?(r.componentJson.recipeConfig.totalCount=i.hits.total.value,(i=i.hits.hits).forEach(function(e,t){i[t].args=[],i[t].args.push(r.componentJson)}),r.componentJson.recipes=i,n=r.getTemplate("recipe-listing",r.defaultSettings.recipeTemplate),r.$el.html(n(r.getModelJSON())),r.favCalled=!0,d.initialize(r.componentJson),r.componentJson.recipeConfig.componentUsageContext="favoritesList",r.$el.find(".c-recipe-listing-filter").removeClass("hidden"),r.$el.find(".c-filter-tags").removeClass("hidden"),r.$el.find(".o-preloader--favorites").addClass("hidden"),r._enableCallBack()):(r.$el.hide(),r.$el.find(".o-preloader--favorites").addClass("hidden"),r.$el.find(".no-data-favourite-cta").removeClass("hidden")):r.$el.hide()},e.onErrorCallback=function(e){r.$el.hide()}):(r.componentJson.recipeConfig.componentUsageContext="",(s=JSON.parse(c.getLocalStorageItem("favourites-"+r.componentJson.brandName+"-"+r.componentJson.locale))).recipeIds.forEach(function(e){o+=e+","}),o=o.slice(0,-1),e.queryParams=o,e.queryParams&&(e.queryParams="?"+r.componentJson.recipeConfig.filterConfig.favouriteParamName+"="+e.queryParams),e.servletUrl=r.componentJson.recipeConfig.filterConfig.ajaxURL,e.onCompleteCallback=function(e){(t=JSON.parse(e)).data.recipeListing.recipes.length?(n=r.getTemplate("recipe-listing",r.defaultSettings.template),t.data.recipeListing.recipes.forEach(function(e){e.args=[],e.args.push(r.componentJson),a+=n(e)}),$(r.recipeList).html(a),d.initialize(r.componentJson),r.componentJson.recipeConfig.componentUsageContext="favoritesList",$(".c-recipe-listing-filter").removeClass("hidden"),$(".c-filter-tags").removeClass("hidden"),$(".c-recipe-listing-sorting").removeClass("hidden")):($(".o-preloader--favorites").addClass("hidden"),$(".no-data-favourite-cta").removeClass("hidden"))},e.onErrorCallback=function(e){r.listingResponse=!0}),c.getDataAjaxMethod(e))},_renderRatings:function(e,t){this.componentJson.isMigrationEnabled&&e.length&&(e[0].recipeRating=this.componentJson.recipeRating),e.length&&e[0].recipeRating&&(e={ratingReview:e[0].recipeRating,recipes:e,brandName:t,ratingObj:e[0].recipeRating.ratings,elm:this.$el.find("[data-componentname]")},l.preRatings(e))},_showRecipeAttributesNew:function(){var l=this;$.each(l.$el.find(l.settings.recipeAttrListItem),function(){var i,n=$(this),r=n.find(l.settings.recipeAttrValue),a=r.data("attributenewname"),o=n.parent().data("recipeid"),s=[],e=l.componentJson.recipes;$.each(l.componentJson.recipeConfig.recipeAttributes,function(){s.push(this.attributeName.toLowerCase())}),$.each(e,function(e,t){this._id!==o.toString()&&this._id!==parseInt(o)||$.each(t._source.recipeData,function(e,t){if(-1!==$.inArray(e.toLowerCase(),s)){if(!l.isRecipeAttributeValueNull(t))return e===a?("prepTime"!==a&&"cookTime"!==a&&"totalTime"!==a||(t=c.parseISODurationString(t)),l.isRequireChangeToHours(a,t)?(i=l.changeToHoursHandler(t),(r=n.find(l.settings.recipeAttrValueWrapper)).html(i)):r.html(t),n.show(),!1):void n.hide();n.hide()}})})})},_showRecipeAttributes:function(){var l=this;$.each(l.$el.find(l.settings.recipeAttrListItem),function(){var i,n=$(this),r=n.find(l.settings.recipeAttrValue),a=r.data("attributename"),o=n.parent().data("recipeid"),s=[],e="carousel-view"===l.componentJson.componentVariation&&"recipeDetailsPage"===l.componentJson.recipeConfig.componentUsageContext?l.componentJson.recipes[0].relatedRecipes:l.componentJson.recipes;$.each(l.componentJson.recipeConfig.recipeAttributes,function(){s.push(this.attributeName.toLowerCase())}),$.each(e,function(e,t){this.recipeId!==o.toString()&&this.recipeId!==parseInt(o)||$.each(t,function(e,t){if(-1!==$.inArray(e.toLowerCase(),s)){if(!l.isRecipeAttributeValueNull(t))return e===a?("difficulties"===a?r.html(t[0].categoryName):l.isRequireChangeToHours(a,t)?(i=l.changeToHoursHandler(t),(r=n.find(l.settings.recipeAttrValueWrapper)).html(i)):r.html(t),n.show(),!1):void n.hide();n.hide()}})})})},isRequireChangeToHours:function(e,t){var i=this.componentJson.recipeConfig.recipeAttributeChangeToHoursThresholdMinutes;return!("cookingtime"!==e.toLowerCase()&&"cookTime"!==e.toLowerCase()&&"preparationtime"!==e.toLowerCase()&&"prepTime"!==e.toLowerCase()&&"waitingtime"!==e.toLowerCase()&&"freezetime"!==e.toLowerCase()&&"chilltime"!==e.toLowerCase()&&"brewtime"!==e.toLowerCase()&&"totaltime"!==e.toLowerCase()||!i||!(i<t))},changeToHoursHandler:function(e){var t=this.componentJson.recipeConfig.recipeAttributeChangeToHoursSuffixText,i=e%60,e=(e-i)/60;return this.getTemplate("recipe-attribute-change-to-hours",this.defaultSettings.changeToHoursTemplate)({minuteValue:i,hourValue:e,minuteSuffix:1<i?t.minsSuffixText:t.minSuffixText,hourSuffix:1<e?t.hoursSuffixText:t.hourSuffixText})},isRecipeAttributeValueNull:function(e){return!(isNaN(e)||0!==e&&null!==e&&0!==e.length)},_showRecipeDietaryAttributesNew:function(){var t=this;$.each(t.$el.find(t.settings.recipeDAListItem),function(){var i=$(this),n=i.find(t.settings.recipeDALabel).data("attributename"),r=i.parent().data("recipeid"),e=t.componentJson.recipes;$.each(e,function(e,t){t._id===r.toString()&&(t._source.recipeData.dietaryClaim&&t._source.recipeData.dietaryClaim.include?$.each(t._source.recipeData.dietaryClaim.include,function(e,t){return n===t?(i.show(),!1):void i.hide()}):i.hide())})})},_showRecipeDietaryAttributes:function(){var t=this;$.each(t.$el.find(t.settings.recipeDAListItem),function(){var i=$(this),n=i.find(t.settings.recipeDALabel).data("attributename"),r=i.parent().data("recipeid"),e="carousel-view"===t.componentJson.componentVariation&&"recipeDetailsPage"===t.componentJson.recipeConfig.componentUsageContext?t.componentJson.recipes[0].relatedRecipes:t.componentJson.recipes;$.each(e,function(e,t){this.recipeId===r.toString()&&(this.dietary?$.each(this.dietary,function(e,t){return n===e?null!==t&&"true"===t.stateValue?i.show():i.hide():void 0}):i.hide())})})},_displyFilters:function(){this.$el.find(this.defaultSettings.filterContainer).hide()},_renderMigrationFilterTags:function(){var s=this,l="";s.$el.find(s.defaultSettings.filterWrapper).each(function(e,t){var i,n=$(this),r=n.data("filter-type"),a=n.data("index"),o="";switch(r){case"dropdown":o=p.getDropdownFilterValue(n,!0);break;case"radioButton":case"checkBox":o=n.is(":checked")?n.val():""}""!==o&&""!==(i=o)&&$(s.settings.filtertags)&&($(s.settings.queryParamsStore).push(r+"__"+o),l+='<li data-filter-type="'+r+'" data-filter-value="'+o+'" data-filter-index="'+a+'">'+i+' <span class="js-remove-filtertag">x</span></li>')}),l&&(s.$el.find(s.settings.filtertagsLabel).addClass(s.settings.filtertagsLabelDisplay),s.$el.find(s.settings.filtertags).html(l))},_renderFilterTags:function(e,t,i){var n=this,r=$(e),e=r.data("filter-type"),r=r.data("index");""!==t&&$(n.settings.filtertags)&&0===$(n.settings.filtertags).find('li[data-filter-value="'+t+'"]').length&&($(n.settings.queryParamsStore).push(e+"__"+t),i='<li data-filter-type="'+e+'" data-filter-value="'+t+'" data-filter-index="'+r+'">'+i+' <span class="js-remove-filtertag">x</span></li>',$(n.settings.filtertagsLabel).addClass(n.settings.filtertagsLabelDisplay),$(n.settings.filtertags).append(i))},_populateData:function(){var t=this,e={},i="";t.componentJson.isMigrationEnabled?(e.queryParams=p.setRecipeMigrationFilterQueryParams(t),e=t._getRecipeMigrationOption(e.queryParams)):(t.componentJson&&t.componentJson.favouritesEnabled&&t.componentJson.recipeConfig&&"favoritesList"===t.componentJson.recipeConfig.componentUsageContext&&(JSON.parse(c.getLocalStorageItem("favourites-"+t.componentJson.brandName+"-"+t.componentJson.locale)).recipeIds.forEach(function(e){i+=e+","}),(i=i.slice(0,-1))&&(e.queryParams?e.queryParams+="&"+t.componentJson.recipeConfig.filterConfig.favouriteParamName+"="+i:e.queryParams="?"+t.componentJson.recipeConfig.filterConfig.favouriteParamName+"="+i)),e.servletUrl=t.componentJson.recipeConfig.filterConfig.ajaxURL,e.queryParams=p.setRecipeFilterQueryParams(t)),e.onCompleteCallback=function(e){t.listingResponse=!0,e&&(e=$.parseJSON(e),t.componentJson.isMigrationEnabled?(t.componentJson.recipes=e.hits.hits,t._updateRecipeListing(e.hits.hits,e.hits.total.value)):(t.componentJson=e.data.recipeListing,t._updateRecipeListing(e.data.recipeListing.recipes,e.data.recipeListing.recipeConfig.totalCount)),t.listingDOMInjected=!0)},e.onErrorCallback=function(e){t.listingResponse=!0},t.listingResponse&&(t.listingResponse=!1,c.getDataAjaxMethod(e))},_highlightSelectedFilter:function(e){var t=this,i=$(e.currentTarget),n=i.attr("type"),e=i.parent(t.settings.filterLabelWrapper);"radio"===n?i.is(":checked")&&(i.parents(t.settings.radioBtnFilterWrapper+","+t.settings.triStateFilterWrapper+","+t.settings.multiValueFilterWrapper).find(t.settings.filterLabelWrapper).removeClass(t.settings.filterActiveCl),e.addClass(t.settings.filterActiveCl)):"checkbox"===n&&(i.is(":checked")?e.addClass(t.settings.filterActiveCl):e.removeClass(t.settings.filterActiveCl))},_filterChangeHandler:function(e){var t=this,i=$(e.currentTarget);$(t.settings.recipeFilters).find(t.recipeFilterExpand).is(":visible")||t._filterApplyHandler(),t._switchCaseHandler(i),t._highlightSelectedFilter(e)},_switchCaseHandler:function(e,t,i,n){var r,a=this,o=e;switch(o.data("filter-type")){case"dropdown":if(i||t){if(i===o.find("option:selected").val()||t===o.data("index")){o.prop("selectedIndex",0),0;break}}else r=o.find("option:selected").val(),o.find("option:selected")||($(a.settings.filtertagsLabel).removeClass(a.settings.filtertagsLabelDisplay),$(a.settings.filtertags).find('li["data-filter-value="'+r+"]").remove());break;case"radioButton":case"checkBox":if(i||t){if(o.is(":checked")&&(i===o.val()||t===o.data("index"))){o.prop("checked",!1),0;break}}else o.is(":checked")||($(a.settings.filtertagsLabel).removeClass(a.settings.filtertagsLabelDisplay),$(a.settings.filtertags).find('li[data-filter-value="'+o.val()+'"]').remove());break;case"triStateButtonGroup":case"multiValueButtonGroup":o.is(":checked")&&t===o.data("index")&&(o.prop("checked",!1),0);break;case"rangeFinder":t===o.data("index")&&(o.slider("refresh"),0)}},_removeFilterTagHandler:function(e){var n=this,e=$(e.currentTarget).parent(),r=e.data("filter-value"),a=e.data("filter-index");$(n.recipeFilterBlock).find("."+n.defaultSettings.filterActiveCl).removeClass(n.defaultSettings.filterActiveCl),$(n.settings.filterWrapper).each(function(e,t){var i=$(this);n._switchCaseHandler(i,a,r,!1)}),e.remove(),n._populateData()},_filterApplyHandler:function(){var e=this;e.pageNum=e.settings.startPageNum,e.isPageLoad=!0,$(e.preloaderContent).removeClass(e.hiddenClass).show(),e.settings.isLoadMoreClicked&&(e.settings.isLoadMore=!1),e._populateData(),e._filterCollapseHandler()},_filterClearHandler:function(e){var t=this,i=!1;$(t.settings.filtertags).html().length&&(i=!0),$(t.recipeFilterBlock).find("select").prop("selectedIndex",0),$(t.recipeFilterBlock).find("input").prop("checked",!1),$(t.recipeFilterBlock).find("."+t.defaultSettings.filterActiveCl).removeClass(t.defaultSettings.filterActiveCl),$(t.settings.rangeSliderInputWrapper).slider("refresh"),"cancel"!==e&&i&&($(t.settings.filtertagsLabel).removeClass(t.settings.filtertagsLabelDisplay),$(t.settings.filtertags).html(""),t._populateData()),t._filterCollapseHandler()},_filterCancelHandler:function(){var e=this.settings.queryParamsStore;this._filterClearHandler("cancel");for(var t=0;t<e.length;t++){var i=e[t].split("__")[0],n=e[t].split("__")[1];switch(i){case"dropdown":$(this.settings.filterTypeDropdown).val(n).prop("selected",!0);break;case"radioButton":case"checkBox":$(this.settings.filterWrapper).filter(function(){return this.value===n}).prop("checked",!0)}}},_filterExpandHandler:function(){$(this.recipeFilterExpand).show(),$(this.moreFilter).hide()},_filterCollapseHandler:function(){$(this.recipeFilterExpand).hide(),$(this.moreFilter).show()},_filterSeeHandler:function(e){var t=this;c.animate("html, body",{scrollTop:t.$el.find(t.recipeFilterBlock).offset().top-144},400),t.$el.find(t.filterWrapperSticky).removeClass("stick"),t.$el.find(t.recipeSorting).show(),t.$el.find(t.clearFilter).show(),t.$el.find(t.showFilter).addClass(t.hiddenClass)},_updateRecipeListing:function(e,t){var i=this,n=$(e),r=i.settings,a="",o=i.getTemplate("recipe-listing",r.template),s=p.setRecipeFilterQueryParams(i,"history");i.componentJson.isMigrationEnabled&&i._renderMigrationFilterTags(),i.componentJson.recipeConfig.totalCount=t,i.$el.find(i.filterResultCount).find("span").text(i.componentJson.recipeConfig.totalCount),i.settings.enableHistory&&(i.pushHistory&&(i.isHistoryPop=!1,c.historyPushState({},null,s,i.settings.urlCharacterLimit,!0)),i.historyFilterHandler(i,!1)),n.length&&n.each(function(e,t){t.args=[],t.args.push(i.componentJson),a+=o(t)}),0<t?(i.$el.find(i.settings.noResult).add(i.alternateResult).hide(),i.$el.find(r.preloader).addClass(i.hiddenClass),1<i.pageNum&&"infiniteScroll"===i.componentJson.recipeConfig.pagination.paginationType?i.$el.find(r.recipeListingList).append(a):i.$el.find(r.recipeListingList).html(a),i.$el.find(r.ctaAnchor).text(i.componentJson.recipeConfig.ctaLabelText),i.componentJson.recipeConfig.pagination?(i._renderPagination(t),i._updateParamsOnPageScroll(t),t>i.componentJson.recipeConfig.pagination.itemsPerPage?(i.$el.find(r.pagination).removeClass(i.hiddenClass),i.$el.find(r.loadmoreWrapper).removeClass(i.hiddenClass)):(i.$el.find(r.pagination).addClass(i.hiddenClass),i.$el.find(r.loadmoreWrapper).addClass(i.hiddenClass))):(i.$el.find(r.pagination).addClass(i.hiddenClass),i.$el.find(r.loadmoreWrapper).addClass(i.hiddenClass)),i._initiateLazyLoad(),i.componentJson.isMigrationEnabled?(i._showRecipeAttributesNew(),i._showRecipeDietaryAttributesNew()):(i._showRecipeAttributes(),i._showRecipeDietaryAttributes())):(i.$el.find(r.noResult).show(),i.$el.find(r.loadmoreWrapper).addClass(i.hiddenClass),i.$el.find(r.pagination).addClass(i.hiddenClass),1<i.pageNum&&"infiniteScroll"===i.componentJson.recipeConfig.pagination.paginationType?i.$el.find(r.recipeListingList).append(a):i.$el.find(r.recipeListingList).html(a),a?i.$el.find(i.alternateResult).show():i.$el.find(i.alternateResult).hide(),i.$el.find(i.pagination).add(i.loadmoreWrapper).addClass(i.hiddenClass)),d&&d.initialize(i.componentJson),"undefined"!=typeof ratingReview&&void 0!==ratingReview.widget&&l._kritiqueRatings(ratingReview),i._renderRatings(e,i.componentJson.brandName)},_initiateLazyLoad:function(){},_stickyFilter:function(){var e=this,t=e.$el.find(e.settings.recipeFilters).offset().top;$(window).on("scroll",function(){$(window).scrollTop()>t?(e.$el.find(e.filterWrapperSticky).addClass("stick"),e.$el.find(e.clearFilter).hide(),e.$el.find(e.recipeSorting).hide(),e.$el.find(e.showFilter).removeClass(e.hiddenClass),e.$el.find(e.settings.filterHeadingSticky).show()):(e.$el.find(e.filterWrapperSticky).removeClass("stick"),e.$el.find(e.recipeSorting).show(),e.$el.find(e.clearFilter).show(),e.$el.find(e.showFilter).addClass(e.hiddenClass),e.$el.find(e.settings.filterHeadingSticky).hide())})},_renderPagination:function(e){var t=this.isPageLoad,i=this.componentJson.recipeConfig.pagination;p.generatePagination(e,this,t,i)},_updateParamsOnPageScroll:function(e){var t=this.componentJson.recipeConfig.pagination.itemsPerPage;this.pageScroll=e>t*this.pageNum},_loadMorehandler:function(e){var t=this,i=$(e.currentTarget),n=t.settings;e.preventDefault(),t.pageNum++,i.fadeOut(500),t.$el.find(n.preloader).removeClass(t.hiddenClass),n.isLoadMore=!0,t._populateData()},_paginationHandler:function(e){var t=this,i=$(e.currentTarget);if(i.hasClass("o-btn--disabled")||i.hasClass("o-btn--active"))return e.preventDefault(),!1;$(t.preloaderContent).height($(t.recipeList).height()).removeClass(t.hiddenClass).show(),c.animate("html, body",{scrollTop:$(t.$el).offset().top},500),t.startIndex=t.startIndex+t.componentJson.recipeConfig.pagination.itemsPerPage,t.isPageLoad=!1,p.pagination(t.settings.paginationBtn,i,t),t._populateData()},historyBackHandler:function(e,t){var i=p.getUrlParameter(t.filterId);t.isHistoryPop=!!e,t.pushHistory=!e,t.activeState=!1,t.historyFilterHandler(t,!0),i||t._populateData()},getQuery:function(e,t){return"sort"===e?t.componentJson.sortConfig?c.getQueryParams("st",!0):"":c.getQueryParams(t.filterId,!0,t.urlSeprator)},lastNonEmptyIndex:function(e){for(var t=e.length;t--;)if(""!==e[t])return t;return-1},selectFilter:function(e,t,i,n){var r,a="object"==typeof e?e:$("[name="+e+"]"),e=a[0].tagName.toLowerCase(),i=i;t&&1<=t.indexOf("-")&&(t=t.substr(t.indexOf("-")+1,t.length)),r=""===t&&"select"===e?$.trim(a.find("option").first().text()):decodeURI($.trim(t)),"select"===e?i?a.find("option").filter(function(e){return $.trim($(this).text()).toLowerCase()===r.toLowerCase()}).prop("selected",!0).change():a.find("option").filter(function(e){return $.trim($(this).text()).toLowerCase()===r.toLowerCase()}).prop("selected",!0):(e=$.trim(a.parents("label").text()).toLowerCase(),""!==r&&e===r.toLowerCase()?i?a.prop("checked",!0).change():a.prop("checked",!0):a.prop("checked",!1))},historyFilterHandlerNew:function(a,o){var s=a.getQuery("filter",a),n=a.getQuery("sort",a),i=a.$el.find(a.defaultSettings.filterWrapper).not(".c-product-listing-v2-sort__dropdown"),t=a.$el.find(".c-listing-filter__filter.c-product-listing-v2-sort__dropdown"),l=i.length-1,c=o,p=!1,e=decodeURIComponent(s[s.length-1]).toLowerCase();1<=e.indexOf("-")&&(l=parseInt(e.substr(0,e.indexOf("-")))),s.length?(_.each(i,function(n,r){_.each(s,function(e,t){var i,t=decodeURIComponent(s[t]).toLowerCase();1<=t.indexOf("-")&&(i=parseInt(t.substr(0,t.indexOf("-")))),i===r&&(i===l&&c?p=o=!0:o=!1,a.selectFilter($(n),t,o,a))})}),_.each(n,function(e,i){_.each(t,function(e,t){i===t&&(p&&(o=!1),a.selectFilter($(e),n[t],o,a))})})):(_.each(i,function(e,t){o&&t+1===i.length?p=o=!0:o=!1,a.selectFilter($(e),"",o,a)}),$(a.preloaderContent).addClass("hidden"))},historyFilterHandler:function(e,t){this.componentJson.isMigrationEnabled?this.historyFilterHandlerNew(e,t):this.historyFilterHandlerOld(e,t)},historyFilterHandlerOld:function(n,r){var a,t,o,s=n.getQuery("filter",n),l=n.getQuery("sort",n),c=n.$el.find(n.defaultSettings.filterWrapper).not(".c-recipe-listing-sort__dropdown"),p=n.$el.find(".c-listing-filter__filter.c-recipe-listing-sort__dropdown"),d=r,g=!1;s.length?(_.each(s,function(e,i){t=s[i],a=decodeURI(t.substr(t.indexOf("-")+1,t.length)),o=parseInt(t.split("-")[0]),_.each(c,function(e,t){o===t&&(a===$(e).parents("label").text().trim()&&d?g=r=!0:r=!1,n.selectFilter($(e),s[i],r,n))})}),_.each(l,function(e,i){_.each(p,function(e,t){i===t&&(g&&(r=!1),n.selectFilter($(e),l[t],r,n))})})):(_.each(c,function(e,t){r&&t+1===c.length?g=r=!0:r=!1,n.selectFilter($(e),"",r,n)}),_.each(p,function(e,t){r&&g&&(r=!1),n.selectFilter($(e),l[t],r,n)}))},_initCarousel:function(){this.$el.find(this.defaultSettings.carouselCl).slick({slidesToShow:c.isMobile()?this.defaultSettings.slidesToShowMob:this.defaultSettings.slidesToShow,slidesToScroll:1,speed:this.defaultSettings.carouselSpeed,dots:!0})},_initRangeSliderFilter:function(){var e=this;$(e.rangeSliderInputWrapper).slider(),e._rangeSliderSelectedValueHandler(),$(e.rangeSliderInputWrapper).on("slideStart",function(){e.rangeSliderOnChange($(this))}).on("slide",function(){e.rangeSliderOnChange($(this))}).on("slideStop",function(){e.rangeSliderOnChange($(this))})},_resetRangeFilter:function(e){e=$(e.currentTarget).parent().find(this.settings.rangeSliderInputWrapper);$(e).slider("refresh"),this.rangeSliderOnChange(e)},rangeSliderOnChange:function(e){var t=$(e).slider("getElement"),e=$(e).data("label");$(t).find(".tooltip-main .tooltip-inner").append(" "+e)},_rangeSliderSelectedValueHandler:function(){var e=this;$(e.rangeSliderInputWrapper).each(function(){e.rangeSliderOnChange($(this))})}})})}),define("recipe-listing",["bootstrap","d2-recipe-listing"],function(e){"use strict";return IEA.module("UI.recipe-listing",function(e,t,i){_.extend(e,{onEnable:function(){this.addCloseElements(),this.enableClickingOnTitles()},addCloseElements:function(){var e=this.$el,t=e.find(".c-recipe-listing-filter");e.find(".js-apply-filters").attr("data-dismiss","modal"),t.append('<span class="close-filter" data-dismiss="modal">close</span>')},enableClickingOnTitles:function(){$(this.$el[0]).find(".c-recipe-listing__list-item").click(function(e){$(e.target).parent().hasClass("c-recipe-listing-item-content__container-heading")&&(e=$(this).find("a").first().attr("href"),window.location=e)})}})})});