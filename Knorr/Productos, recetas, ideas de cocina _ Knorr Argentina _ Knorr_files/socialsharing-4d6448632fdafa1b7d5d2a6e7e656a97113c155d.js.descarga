define(["analytics","commonService"],function(){"use strict";var a,i=null,c=null;IEA.service("socialsharing",function(t,e,n){function o(){return this}return _.extend(o.prototype,{initialize:function(t){return i=new IEA.Analytics,c=new IEA.commonService,this},enableSocial:function(e){var o=this,n=!1,t=e.socialSharingMenu,a=e.socialSharing;t.on({mouseover:function(){o._toggleSocialStack(this,!0,e)},mouseleave:function(){o._toggleSocialStack(this,!1,e)},click:function(t){n=n?(o._toggleSocialStack(this,!1,e),!1):(o._toggleSocialStack(this,!0,e),!0)}}),void 0!==a&&a.on({click:function(t){var e=$(t.currentTarget),n=("li"===e.prop("tagName").toLowerCase()?e.find("a"):e).attr("data-title"),t="li"===e.prop("tagName").toLowerCase()?e.parents(".js-social-sharing-toolbox"):e,t=""!==t.attr("addthis:title")?t.attr("addthis:title"):t.attr("addthis:description");n&&o._trackSocialShare(e,n,t)}})},_toggleSocialStack:function(t,e,n){a=a||$(t).find(n.socialSharing),e?(a.stop(!0,!0),c.animate(a.show(),{opacity:1},300)):(a.stop(!0,!0),c.animate(a,{opacity:0},300,0,function(){a.hide()}))},_loadFacebookSdk:function(t,e){var n,o,a,i;$.ajaxSetup({cache:!0}),$.getScript(e,function(){FB.init({appId:t,xfbml:!0,version:"v2.7"})}),n=document,o="script",a="facebook-jssdk",i=n.getElementsByTagName(o)[0],n.getElementById(a)||((o=n.createElement(o)).id=a,o.src=e,i.parentNode.insertBefore(o,i))},_customSocialShare:function(t,e){var n="";switch(e.shareVia){case"twitter":n="https://twitter.com/share/?url="+encodeURIComponent(e.postLink)+"&text="+encodeURIComponent(e.postDescriptionTwitter);break;case"facebook":n="https://www.facebook.com/dialog/feed?app_id="+encodeURIComponent(t)+"&display=popup&description="+encodeURIComponent(e.postDescriptionFacebook)+"&link="+encodeURIComponent(e.postLink)+"&name="+encodeURIComponent(e.postName)+"&redirect_uri="+encodeURIComponent(e.postLink)+"&picture="+encodeURIComponent(e.postImage);break;default:return null}window.open(n,"name","width=600,height=400")},_downloadTrigger:function(t,e){var n="&url="+decodeURIComponent(window.location.href);window.open(e+n+"&no_external_links&no_internal_links&no_javascript&css_media_type=print"),"undefined"!=typeof digitalData&&"undefined"!=typeof ctConstants&&(e={},n=t.parents("[data-componentname]"),t=t.parents("[data-componentname]").data("componentname"),i.trackComponentInfo(n,digitalData),e.eventInfo={type:ctConstants.trackEvent,eventAction:ctConstants.share,eventLabel:t+" - Download - "+document.title,eventValue:1},e.category={primaryCategory:ctConstants.advocacy},e.subcategory="Lead",digitalData.event.push(e))},_trackSocialShare:function(t,e,n){var o,a;"undefined"!=typeof digitalData&&"undefined"!=typeof ctConstants&&(a=(o=t.parents("[data-componentname]")).data("componentname"),t=n||document.title,n={},i.trackComponentInfo(o,digitalData),n.eventInfo={type:ctConstants.trackEvent,eventAction:ctConstants.share,eventLabel:a+" - "+e+" - "+t,eventValue:1},n.category={primaryCategory:ctConstants.advocacy},n.subcategory="Lead",digitalData.event.push(n))}}),o})});