define(["commonService"],function(){"use strict";IEA.service("animService",function(o,n,t){function a(){return this}var e=1400,i=985,l=!1,c=null,r=null,s=null;return _.extend(a.prototype,{initialize:function(){var n=this;return s=new IEA.commonService,$('[data-anim="scroll"]').click(function(o){o.preventDefault(),n.scrollTo($($(this).attr("href")).offset().top)}),n.mobileCheck(),this},mobileCheck:function(){var o;return s.isMobile()&&$(window).width()<=i||s.isMobileAndTablet()?(l=!0,o=(e=i)/3,s.animate(".o-modal-content",{scrollTop:o,scrollLeft:o},1e3)):l=!(e=1400),l},blurBackground:function(o,n){for(var t=0;t<o.length;t++){var a=o[t];n?$("."+a).addClass("u-blur-background"):$("."+a).removeClass("u-blur-background")}},initProducts:function(){var t,a,e=$('[data-anim="product"]');0<e.length&&(t=e.first().offset().top,a=$(window).height(),$(document).on("scroll",function(o){var n=$(window).scrollTop();t-a/1.5<n&&e.each(function(o,n){$(n).delay(300*o).queue(function(o){s.animate(this,{scrollTop:-8,opacity:1},800),o()})})}))},initParallax:function(a){var e,o=$('[data-anim="parallax"]');0<o.length&&(e=$(window).height(),o.each(function(){var t=$(this);$(document).scroll(function(){var o=$(window).scrollTop(),n=t.offset().top;n+t.outerHeight()<=o||o+e<=n||(o=Math.round((n-o)*a),t.css("background-position","center "+o+"px"))})}))},initParallaxEffect:function(o,i){function n(){t.each(function(o,n){var t,a,e;t=$(n),a=l.height(),e=l.scrollTop(),((n=t.offset().top)+t.outerHeight()<=e||e+a<=n)&&!i||(a=Number(t.attr("data-anim-speed")),a={webkitTransform:"translate3d(0, "+(a=Math.round((n-e)*a))+"px, 0)",MozTransform:"translate3d(0, "+a+"px, 0)",msTransform:"translate3d(0, "+a+"px, 0)",OTransform:"translate3d(0, "+a+"px, 0)",transform:"translate3d(0, "+a+"px, 0)"},t.css(a))}),"function"==typeof o.parallaxScrollingHandler&&o.parallaxScrollingHandler()}var t=o.$el.find('[data-anim="parallax"]'),l=$(window);0<t.length&&(l.on("scroll",n),n())},initZoom:function(){var n=this,o=$("[data-zoom-image]");null===c?0<o.length&&(c=$(".js-modal"),r=c.find(".js-modal-image"),o.each(function(){n.zoomEvents($(this),n)}),r.mousemove(function(o){n.zoomMove($(this),o.clientY)}),r.on("click",function(){s.animate(c,{opacity:0},1e3,0,function(){c.css("display","none")}),$("body").removeClass("open-zoom-modal").removeAttr("style")})):o.each(function(){$(this).off("click").unbind(),n.zoomEvents($(this),n)})},zoomOpenUrl:function(o){var n=this;null===c&&(c=$(".js-modal"),(r=c.find(".js-modal-image")).mousemove(function(o){n.zoomMove($(this),o.clientY)}),r.on("click",function(){$("body").removeClass("open-zoom-modal").removeAttr("style"),s.animate(c,{opacity:0},1e3,0,function(){c.css("display","none")}),n.blurBackground(["js-blur-bg"],!1)}),$(document).keyup(function(o){27===o.keyCode&&$(".js-modal-image").trigger("click")})),n.mobileCheck(),this.zoom(o,window.innerHeight/2),n.blurBackground(["js-blur-bg"],!0),r.parent(".o-modal-content")&&s.animate(r.parent(".o-modal-content"),{scrollTop:0})},zoomEvents:function(n,t){n.on("click",function(o){t.zoom(n.data("zoom-image"),o.clientY)})},zoom:function(o,n,t){null!==c&&(r.css("backgroundImage",'url("'+o+'")'),t=void 0!==t?t:e,s.isMobile()?r.width(i):r.width($(window).width()),r.height(t),$("body").css("overflow","hidden"),c.show(),s.animate(c,{opacity:1},1e3))},zoomMove:function(o,n,t){var a=void 0!==t?t:e,t=$(window).height(),a=a-t,a=(1-n/t)*a-a;s.isMobileAndTablet()||o.css("top",a+"px")},zoomSwap:function(o,n){null===c&&(c=$(".js-modal"),(r=c.find(".js-modal-image")).css("backgroundImage",'url("'+o+'")'),s.animate(r,{opacity:0},500,0,function(){r.css("backgroundImage","url("+o+")"),s.animate(r,{opacity:1},500)}))},openOverlay:function(o,n,t){o=$(o);n=$.extend({onCompleteCallback:function(){}},n),null!==o&&($("body").addClass("o-modal-open"),o.show(),s.animate(o,{opacity:1},1e3,0,function(){n.onCompleteCallback()}),t||this.blurBackground(["js-blur-bg"],!0))},closeOverlay:function(o,n){s.animate(o,{opacity:0},1e3,0,function(){$(o).css("display","none")}),$("body").removeClass("o-modal-open"),n||this.blurBackground(["js-blur-bg"],!1)},scrollTo:function(o){s.animate("html, body",{scrollTop:o},1e3)}}),a})});