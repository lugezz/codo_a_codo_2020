/* Version=6.6.14,Timestamp=2020-12-24T09:28:36.549Z */define("live-chat-v2",["iea","analytics","lazyLoadService","commonService"],function(i){"use strict";var a=null,n=null,r=null;function e(){}return _.extend(e.prototype,{defaultSettings:{liveChatV2Wrapper:".c-live-chat-v2__wrapper",ccoreBotScriptId:"getokenfromlink",fbTemplate:"live-chat-v2/partial/fb-messenger.hbss",animateButton:"animate-messanger-button",messangerButton:"hide-messanger-button"},init:function(e){var t=this;a=new i.Analytics,r=new i.LazyLoad,n=new i.commonService,t.el=$(e),t.el.attr("data-messenger-config")&&(t.messengerConfig=JSON.parse(t.el.attr("data-messenger-config"))),"fbMessengerOnly"===t._getChatService()&&("facebookCustomerChatPlugin"===t._getWidgetType()?t.el.find(".live-chat-v2-toggle").click(function(e){t.el.find(".live-chat-v2-toggle").addClass(t.defaultSettings.animateButton),t._loadSDK(r,t.el),t._renderFBMessenger()}):(t._loadSDK(r,t.el),t._renderFBMessenger())),"liveChatWithOtherService"===t._getChatService()&&"fbMessenger"===t._getOtherChatService()&&r.lazyLoadFeature(t.el,function(){t._renderLiveChatFBMessenger(r,t.el)}),n.listenEvent("ccoreScriptLoaded",function(e,t){var n,i=0;"object"==typeof liveagent?window.liveagent.init("https://d.la1-c2-lo2.salesforceliveagent.com/chat","5720L0000008dXQ","00DE0000000bbLj"):"true"===t.ref.sfLiveAgent&&(n=setInterval(function(){"object"==typeof liveagent&&(window.liveagent.init("https://d.la1-c2-lo2.salesforceliveagent.com/chat","5720L0000008dXQ","00DE0000000bbLj"),clearInterval(n)),10<i&&clearInterval(n),i++},1e3))}),t.el.find(".ccore-bot-toggle").click(function(e){e.preventDefault(),$("#bot").toggle(),t._loadCCoreAPI(function(){n.dispatchEvent("ccoreScriptLoaded",t)})})},_loadSDK:function(e,t){var n=this,i="facebookCustomerChatPlugin"===n._getWidgetType()?"/sdk/xfbml.customerchat.js":"/sdk.js",i="//connect.facebook.net/"+n._getMarket()+i;e.preLoader(t,!0),"undefined"==typeof fbAsyncInit&&$.getScript(i).done(function(){window.fbAsyncInit=function(){FB.init({appId:n._getFbAppid(),autoLogAppEvents:!0,xfbml:!0,version:"v3.0"}),"facebookCustomerChatPlugin"===n._getWidgetType()&&(FB.CustomerChat.update({logged_in_greeting:n._getLoggedInGreeting(),logged_out_greeting:n._getLoggedOutGreeting(),greeting_dialog_display:n._getGreetingDisplayOption(),greeting_dialog_delay:n._getGreetingDelay(),theme_color:n._getThemeColor()}),FB.Event.subscribe("customerchat.dialogShow",function(){n.el.find(".live-chat-v2-toggle").addClass(n.defaultSettings.messangerButton),n.el.find(".live-chat-v2-toggle").removeClass(n.defaultSettings.animateButton),n._trackChatOpen()})),e.preLoader(t,!1)}})},_renderFBMessenger:function(){var e=this,t=i.currentInstance.getTemplate("fb-messenger",e.defaultSettings.fbTemplate),n={brandName:e._getBrandName(),dataRef:e._getDataRef(),fbAppId:e._getFbAppid(),widgetType:e._getWidgetType(),fbPageId:e._getFbPageId(),messengerCtaLabel:e._getMessengerCTA(),buttonColour:e._getBtnColor(),buttonSize:e._getBtnSize(),loggedInGreeting:e._getLoggedInGreeting(),loggedOutGreeting:e._getLoggedOutGreeting(),greetingDisplayOptions:e._getGreetingDisplayOption(),greetingDelay:e._getGreetingDelay(),themeColorHex:e._getThemeColor()};e.el.find(e.defaultSettings.liveChatV2Wrapper).html(t(n))},_renderLiveChatFBMessenger:function(t,n){var i=this,a=setInterval(function(){var e=i.el.find("[id^='liveagent_button_online_']");e.length&&(clearInterval(a),e.is(":hidden")&&("messageUs"===i._getWidgetType()||i._loadSDK(t,n),i._renderFBMessenger()))},100)},_trackChatOpen:function(){var e,t,n;"undefined"!=typeof digitalData&&"undefined"!=typeof ctConstants&&(t={},n=(e=this.el).data("chat-service"),a.trackComponentInfo(e,digitalData),t.eventInfo={type:ctConstants.trackEvent,eventAction:ctConstants.chat,eventLabel:"Chat Open / "+n,eventValue:1},t.category={primaryCategory:ctConstants.other},t.subcategory="Interest",digitalData.event.push(t))},_loadCCoreAPI:function(e){var t,n,i;document.getElementById(this.defaultSettings.ccoreBotScriptId)||(n=(t=this).el.attr("data-ul-chatbot-SFLiveAgent"),i=t.el.attr("data-ul-chatbot-SFScript"),t.unileverChatbotApiUrl=t.el.data("ul-chatbot-api-url"),t.unileverChatbotCSSUrl=t.el.data("ul-chatbot-css-url"),"true"===(t.sfLiveAgent=n)&&i&&$("head").append(decodeURIComponent(i)),i=this._createCCoreScript(e),(e=document.getElementsByTagName("script")[0]).parentNode.insertBefore(i,e),t.unileverChatbotCSSUrl&&((e=document.createElement("link")).rel="stylesheet",e.href=t.unileverChatbotCSSUrl,document.head.appendChild(e)))},_createCCoreScript:function(e){var t=this,n=document.createElement("script"),i=t.el.data("ul-chatbot-brand"),a=t.el.data("ul-chatbot-market"),r=t.el.data("ul-chatbot-id"),g=[];return i&&g.push("brand="+i.trim()),a&&g.push("locale="+a.trim()),r&&g.push("id="+r),n.id=t.defaultSettings.ccoreBotScriptId,e&&(n.onload=function(){e(!0)}),n.src=t.unileverChatbotApiUrl+"?"+g.join("&"),n},_getBrandName:function(){return this.el.data("brand-name")},_getChatService:function(){return this.el.data("chat-service")},_getOtherChatService:function(){return this.el.data("other-chat-service")},_getMarket:function(){return this.el.data("market")},_getFbAppid:function(){return this.messengerConfig?this.messengerConfig.fbAppId:this.el.data("fb-api")},_getWidgetType:function(){return this.messengerConfig?this.messengerConfig.widgetType:this.el.data("widget-type")},_getFbPageId:function(){return this.messengerConfig?this.messengerConfig.fbPageId:this.el.data("fb-page-id")},_getBtnColor:function(){return this.messengerConfig?this.messengerConfig.buttonColour:this.el.data("btn-color")},_getBtnSize:function(){return this.messengerConfig?this.messengerConfig.buttonSize:this.el.data("btn-size")},_getDataRef:function(){return this.messengerConfig?this.messengerConfig.dataRef:this.el.data("fb-ref")},_getMessengerCTA:function(){return this.messengerConfig?this.messengerConfig.messengerCtaLabel:this.el.data("messenger-cta")},_getThemeColor:function(){return this.messengerConfig?this.messengerConfig.themeColorHex:this.el.data("theme-color")},_getLoggedInGreeting:function(){return(this.messengerConfig?$(this.messengerConfig.loggedInGreeting):$(this.el.data("loggedin-greeting"))).text()},_getLoggedOutGreeting:function(){return(this.messengerConfig?$(this.messengerConfig.loggedOutGreeting):$(this.el.data("loggedout-greeting"))).text()},_getGreetingDisplayOption:function(){return this.messengerConfig?$(this.messengerConfig.greetingDisplayOptions):this.el.data("greeting-display")},_getGreetingDelay:function(){return this.messengerConfig?$(this.messengerConfig.greetingDelay):this.el.data("greeting-delay")}}),i.currentInstance.on("components:loaded",function(){$(".c-live-chat-v2").length&&$(".c-live-chat-v2").each(function(){(new e).init(this)})}),i.ChatService=e});